이번 섹션은 데이터 기반 의사결정과 머신러닝에 필수적인 몇 가지 기본 통계 개념을 배운다.  

#### 학습목표
1) Statistical estimation and inference
2) Parametric and non-parametric approaches to modeling
3) Common statistical distributions
4) Frequentist vs. Bayesian statistics

Estimation vs Inference으로 시작해서 Estimation에 대해 이야기 할 때 본질적으로 추정값이 샘플의 평균 같은 특정 매개 변수의 추정값을 제공한다는 것을 강조한다.  
![image](https://user-images.githubusercontent.com/40943064/119671272-9af28180-be74-11eb-8dd4-3dae53831e0b.png)
![image](https://user-images.githubusercontent.com/40943064/119671304-a2198f80-be74-11eb-9e95-1907d20c8392.png)

Estimation은 통계적 추론의 일부에 속한다. 통계적 추정에서, 샘플링하는 모집단의 기본 파라미터에 대한 표준에러와 같은 다른 매개 변수뿐만 아니라 평균 추정치를 포함하여 모집단의 기본 분포를 이해하려고한다.  

이제 ML과 통계적추론의 정의는 유사하다. 이 과정을 통해 배운배우고 사용하는 상당수가 통계기초에서 실제로 얽히고 구축되어 오늘날 우리가 가진 컴퓨팅 능력을 갖기 전에 적용되는 정도를 보게 될 것입이다.  
ML과 SI에서 실제 세계의 실제 기본 인구 분포와 해당 데이터를 생성 한 모델을 추론하기 위해 일부 샘플 데이터를 사용한다.  
여기서 데이터 생성 프로세스를 말할 때 선형 모델은 x와 y 변수 간의 실제 결합 분포를 나타내는 데이터 생성 프로세스의 예라고 생각할 수 있다.  
ML에서 전체 분포에 관심이 있거나 평균의 포인트 추정값을 얻는 것과 같은 분포의 일부 기능에 관심을 가질 수 있다.  
기본/모든 매개 변수의 개별 효과를 이해하는 데 초점을 맞춘 기계 학습에는 통계적 추론에서 가져온 도구가 필요하다.  
반면 일부 ML 모델은 분포의 기본 매개 변수의 이러한 모든 다른 매개 변수에 약간만 초점을 맞추고 대신 **예측 결과 또는 해당 추정**에만 초점을 맞춘다.  

**비즈니스 예제:고객 이탈**
이탈과 관련된 데이터에는 고객이 이탈했는지 여부에 대한 목표 변수가 존재한다.  
우리는 고객이 회사를 떠나는 것을 원하지 않으므로 더 낮은 이탈률을 원한다. 이탈과 관련된 데이터에는 특정 고객의 이탈 여부에 대한 목표 변수가 포함될 수 있다.  
또한 유지기간, 구매유형 및 금액, 기타 고객, 나이, 위치 등과 같은 특성등과 같이 예측에 도움이되는 기능도 포함한다.  
예측은 고객이 떠나거나 떠나지 않을 **확률**을 추정하는 점수를 예측하여 접근하는 경우가 많다.  
0.99는 가능성이 매우 높다는 것을 의미하고 0.01은 고객을 붙잡을 것이라는 것을 의미한다.  
여기서, 추정과 추론에 대해 이야기 할 때 각 feature의 영향을 추정 할 수 있다.  
매해마다 누군가가 고객이되었고, 이 기능이 이탈 할 가능성이 20 % 적다는 것을 생각해보자.  
따라서 매년 추가되는 가치에 대한 추정치를 제공한다.  
추론에 대해 이야기 할 때 간격을 구하는 것으로도 확장 할 것이므로 추정치의 통계적 유의성을 얻을 수 있다.  
예를 들어 이탈 가능성이 20 % 감소하는 대신 방금 말한 내용을 사용하여 해당 추정치에 대해 95 % 신뢰 구간을 가질 수 있으며, 그 효과는 19 %에서 21 % 사이이다.  
따라서 우리는 고객이 추가되는 해마다 고객이 19 세에서 21 세 사이가 될 것이라고 확신 할 것이다. 

데이터를 살펴보면 계정 유형, 고객 특성, 고객 당 수익, 해당 고객 만족도 점수 및 고객 평생 가치에 대한 고객 평생 가치 추정치가 해당 고객을 보유한 전체 기간 동안의 구매 금액이 포함된다.  
고객이 이탈했는지 여부와 일부 이탈 카테고리에 대한 정보도 포함된다.  
독을 갱신하지 않는 것과 적극적으로 취소하는 것과 같은 다양한 이탈 유형을 생각할 수 있다.  
전화 서브 샘플에 대한 데이터, 이것은 전화 구독에 대한 것이며 변수 df_phone에 할당 된 Pandas DataFrame에 포함되어 있다.  
따라서 다음 두 슬라이드에서 일부 EDA를 살펴보면서 예제를 통해 염두해두자.  

**barplot**   
y : 이탈가능성 x : 여러 결제 유형에 대해 살펴보자.  
막대 그래프에 신뢰 구간을 추가하지는 않는다. credit card를 사용하는 사람들이 큰 인출 지불이나 우편 수표를 사용하는 사람들보다 이탈 가능성이 훨씬 적다는 것을 알 수 있다.  
![image](https://user-images.githubusercontent.com/40943064/119674707-62a07280-be77-11eb-95be-19cdb2a70272.png)  
유지 months로 이탈 가치를 볼 수도 있다(pd.cut).  
막대 그림을 만들 때마다 x 축이 categorical 변수가되는것이 좋다. 유지 기간이 짧은 경우 이탈 가능성이 훨씬 더 높다.
![image](https://user-images.githubusercontent.com/40943064/119675586-24f01980-be78-11eb-8e29-f742168f0645.png)  

**pair plot**  
유지월수, features(고객으로 보유한 개월 수, 월당 기가 바이트 사용), 고객 평생 가치(CLTD), 고객이 가져온 총 수익이며, 이탈 가치를이용하여 본다.
pair plot을 이용하여 각 변수 간의 관계를 확인한 다음 이를 분할 한다. hue는 이탈율로 설정한다.   
파란색 미이탈, 녹색은 이탈이다. 변수간 관계와 각변수 분포를 볼 수 있다.
![image](https://user-images.githubusercontent.com/40943064/119674661-587e7400-be77-11eb-91bd-fa913ed8b54a.png)  

**hexbin**   
유지 월수 vs 월별 지출으로 본다. 더 많이 청구되는지, 그들이 머무를 가능성이 더 높은지, 아니면 더 비싼 고객이 머무를 가능성이 적거나 더 높은지 확인 할 수 있다.  
플롯 상단에서 월별 임기 내역 분포를 볼 수 있으며 플롯 오른쪽에서 월별 요금 분포를 볼 수도 있습다.  
오른쪽 상단 모서리에 밀도가 표시된다. 즉, 더 긴 임기 개월과 더 높은 월 요금을 가진 사람들이 더 많이 있다는 것을 알 수 있다.  
그러나 스펙트럼의 다른 쪽 끝에서도 몇 달 동안 임기가 낮은 사람들을 볼 수 있다. 
또한 월별 요금이 평균보다 높으며,이 두 값 사이에서 밀도가 훨씬 낮다는 것을 알 수 있다.  
![image](https://user-images.githubusercontent.com/40943064/119674605-4c92b200-be77-11eb-8176-cb5f0b21e623.png)  


#### Parametric vs. Non-parametric
Statistical inference는 데이터의 기본 데이터 생성 프로세스를 찾는 것이다.  
여기서 통계 모델은 데이터가 취할 수 있는 가능한 분포 또는 데이터를 이용해 얻을 수 있는 회귀가 된다.  

#### Parametric model
통계 모형의 특정 유형이다. 일부 주요 features 또는 parametric 모델은 제한된 수의 parameter로 제한되며, 데이터의 원 분포에 대한 몇 가지 엄격한 가정에 의존한다.  

#### Non-parametric model
추론이 특정 분포에서 추출되는 데이터에 **의존하지 않고** 여러 가정에 의존하지 않는다. 그렇다고 아무것도 모르는것은 아닌고 데이터의 insight를 사용한다.  
Non-parametric 추론의 예는 히스토그램을 사용하여 데이터의 분포를 생성하는 것이다. 따라서 특정값이 실제 데이터에 따라 어디에 속할지에 대한 확률로 CDF 또는 누적 분포 함수를 결정한다.  
즉, 정규 혹은 지수 분포등을 가정하는 대신 표본에서 추출한 실제 데이터에 의해 정의된 분포를 사용한다.  
이 경우 정규분포에 필요한 모수를 지정하지 않는다.  
![image](https://user-images.githubusercontent.com/40943064/119848102-81216f00-bf46-11eb-8155-fcb7938c7727.png)

일반적인 OLS를 생각해보자. 이때 feature에 따라 coefficient의 수를 미리 정의한다. 여기서 선형 분포를 하는것이다.  
즉, 매개 변수와 제약 조건이 존재한다. 이러한 모수적 모델이 더 쉽고 빠르게 해결될 수도 있지만, 이런 제약조건이 없는 non-parametric 모델에 비해 제약을 받게 될 수도 있다. 특정 모수 모형, 즉 정규 분포를 보면  정해진 수의 parameter, 즉 평균과 표준 편차에 의존하게 된다. 그것은 정규분포를 사용했다는 가정하에 우리의 정규분포가 실제로 어떻게 보이는지를 정의하는 매개 변수가 될 것이다.  


가장 일반적인 parametric 모델링 방법은 Maximum liklihood 이다. liklihood function은 확률과 관련이 있으며 parameter에 대한 함수이다. 정규 분포의 경우, 이러한 모수는 평균과 표준 편차였다. 여기서 우리의 liklihood 함수는 parameter를 변수로 하는 함수가 된다. 우도 함수를 모든 데이터를 취하여 "우리가 보는 표본 데이터를 고려할 때 평균에 대해 가장 가능성이 높은 값과 표준 편차에 대해 가장 가능성이 높은 값은 무엇인가? " 표본에 주어진 가장 가능성이 높은 매개변수는 무엇인가? 그것이 MLE가 될 것이다. 이후 liklihood 함수를 최대화할 각 모수의 값을 선택한다. 우리가 가지고 있는 데이터를 고려할 때 가장 발생할 가능성이 높은 값을 최대화할 것이다.  
![image](https://user-images.githubusercontent.com/40943064/119848209-98605c80-bf46-11eb-8fc8-da8161a7564e.png)


#### Uniform distribution  
주사위 던지기가 대표적인 예이다.
![image](https://user-images.githubusercontent.com/40943064/119848285-a9a96900-bf46-11eb-99c5-e28f352a4a6f.png)


#### Gaussian distribution
또한 정규 분포 또는 가우스 분포가 있으며 통계에서 매우 흔하고 널리 사용된다.  
가장 가능성이 높은 값은 평균에 가장 가까운 값일 것이고 어느 한쪽에서 더 멀리 떨어져 있는 값은 평균으로부터 멀어질수록 똑같이 가능성이 없다.  
그래프에서 각 그래프의 위치를 정의하는 다른 평균과 해당 곡선이 얼마나 퍼져 있거나 뾰족한지를 정의하는 다른 표준 편차, 여기서 표준 편차가 작을수록 정규 분포가 더 조여지고 곡선에 대한 점이 나타난다.  
이와같이 normal distribution이 흔히 사용되는 이유는 central limit theorem 때문이다.  
여러 표본에서 평균값을 구하면 랜덤 표본이 여러 개 있고 랜덤 표본의 각 평균값을 구하면 해당 평균의 분포는 정규 곡선이 되는 정리이다.  
실제로 대부분의 사람은 평균키에 근접하고 확률이 낮은영역의 케이스는 얼마 보지 못한다.
![image](https://user-images.githubusercontent.com/40943064/119848317-ae6e1d00-bf46-11eb-9150-ac521438fa1f.png)

#### Log normal distribution
이 변수의 로그를 취하면 정규 분포가 된다는 생각이다. 이전에 우리는 편향된 데이터를 수집하고, 데이터에 대한 로그 변환을 수행하며, 보다 정규적으로 분포된 데이터 세트를 얻는 방법을 보았다. 이제 표준 편차에 대한 평균 값이 더 촘촘할수록 정규 곡선에 더 가깝게 보인다. 큰 특이치가 있다고 생각한다면, 더 큰 꼬리를 가질 것이고, 이때문에 더 큰 표준 편차가 존재할 것이다. 이 그래프를 볼 때 더 작은 표준 편차가 정규에 가깝다는 개념이다. 현실 세계에서 흔히 볼 수 있는 것은 돈을 다룰 때인데, 예를 들어, 대부분의 사람들이 평균적으로 생활하는 가계 소득의 경우, 왼쪽을 예로 들어보자면, 중위 소득의 6만명에 가깝다. 그리고 오른쪽으로는 큰 특이치를 가진다. 억만장자 등등. 이 긴 꼬리를 만든다.
![image](https://user-images.githubusercontent.com/40943064/119848350-b62dc180-bf46-11eb-8a6f-e8ceb919dba7.png)

#### Exponential curve
대부분의 데이터는 왼쪽에 치우치도록 할 것이고 다음 사건이 발생할때까지의 시간을 말하는데 자주 사용한다.  
예를 들어, 두명이 이 비디오를 순서대로 보는 시간의 간격을 들 수 있다. 1분 정도 후에 다른 사람이 다시 시작한다고 가정해 보자. 그리고 대부분 사람들은 1분 정도 된다. 어떤 시점에서는 그림처럼 길게 퍼져있기도 하고, 다음 사람이 이 비디오를 보기 10분에서 15분 전에 휴식 시간이 발생할 가능성이 낮다. 
![image](https://user-images.githubusercontent.com/40943064/119848419-c34ab080-bf46-11eb-9aad-8e63deb8b1b6.png)

#### Poisson distribution
일정 시간 동안 일어난 사건들의 수를 생각할 수 있다. 특정 시간 동안 발생한 사건의 수는 분포의 평균값과 분산값인 람다로 나타난다. 앞으로 10분 안에 얼마나 많은 사람들이 이 비디오를 보게 될것인가? 람다가 하나라면, 우리는 대부분 10분마다 한 명씩만 보고 나머지 확률은 없다고 할 수 있다. 하지만 10분마다 한명씩은 보게 될 것이다.그러면 표준 편차가 더 많이 퍼져나갈 것이다. 더 큰 값을 가질 때 5~15에 가까울 수 있기 때문이다.
![image](https://user-images.githubusercontent.com/40943064/119848439-c8a7fb00-bf46-11eb-88a1-73d453598060.png)
