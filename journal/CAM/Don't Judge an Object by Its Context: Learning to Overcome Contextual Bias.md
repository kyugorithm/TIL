## Abstract 
기존 모델은 종종 개체와 개체 컨텍스트 간의 동시 발생을 활용하여 인식 정확도를 향상시킨다.  
그러나, 특히 전형적인 동시발생 패턴이 없는 경우, 문맥에 의존하는것은 일반화에 리스크가 있다.  
연구는 학습된 feature 표현에 대한 robustness를 향상하기 위해 contextual bias를 다루는데 집중한다.  
목표는 **문맥이 없는 상태에서 문맥과 함께 발생할 때 성능에 영향을 주지 않고 카테고리를 정확하게 인식하는 것**이다.  
핵심 아이디어는 동시발생 컨텍스트에서 한 카테고리의 피쳐 표현을 decorrelate하는 것이다.  
우리는 category와 context를 모두 나타내는 공동 feature 부분 공간과 함께 context 없을 때 발생하는 category를  
명시적으로 나타내는 feature 부분 공간을 학습하여 이를 달성한다.  
간단하면서도 효과적인 방법은 두 개의 다중 레이블 작업(object/attribute classification)으로 확장할 수 있다.  
4개의 데이터 세트에서 context bias를 줄이는 방법의 효과를 보여준다.  

## 1. Introduction
Visual context는 장면 해석 및 물체 인식을 위한 인간 시각 시스템에 대한 귀중한 보조 단서 역할을 한다.  
Context는 물체와 장면 동시 발생할 수 있다. (예: "보트"는 종종 "야외 물"에 나타남)이거나  
주어진 장면에서 둘 이상의 개체(예: "스키" 와 "스키 타는 사람").  
시각 신호가 모호하거나 불완전할 때(예: occlusion, 장면 캡처의 관점 등으로 인해) context는 시각 시스템에 특히 중요하다.  
과거 연구는 context를 명시적으로 모델링하고 classification 및 detection과 같은 표준 시각적 작업에 대한 이점을 보여준다.  
한편, CNN은 의도적으로 context를 암시적으로 캡처한다. DNN은 훈련을 위해 주석이 달린 대규모 데이터 세트의 가용성에 의존한다.  
강조한 바와 같이 제작자의 최선의 노력에도 불구하고 유명한 여러 vision 데이터 세트는 여러 형태의 편향에 시달린다.  
객체 범주 "전자 레인지"를 고려해 보면 이 범주에 속하는 이미지의 상당 부분은  
"냉장고", "주방 싱크대" 및 "오븐"과 같은 다른 개체가 자주 발생하는 주방 환경에서 캡처될 가능성이 높다.  
이는 의도치 않게 이러한 데이터 세트에서 상황에 따른 편향을 유발할 수 있으며, 결과적으로 이에 대해 훈련된 모델에 스며들 수 있다.  
특히, 편향된 훈련 데이터 세트에서 양성 및 음성 인스턴스를 분리하는 feuature를 학습하는 과정에서  
심층 판별 모델은 매우 자주 관심 범주와 함께 발생하는 context를 강력하게 포착할 수 있다.  
이 문제는 이러한 편향된 범주의 명시적 위치 주석(예: 경계 상자 및 분할 마스크)이 없고 훈련 중인 모델이  
다중 레이블 분류를 수행하기 위해 이미지 수준 주석에만 의존해야 하는 설정에서 악화된다.  
위치 주석이 없는 상황에서 이러한 context bias category를 localize하는 방법을 모델이 암묵적으로 학습하도록 하는 것은 어렵다.  

모델이 실수로 그러한 상관 관계를 학습하더라도 문제가 될까? 우리는 이것이 두 가지 측면에서 문제를 일으킬 수 있다고 생각한다.  

1) "야외" 장면 또는 "냉장고"가 없는 경우와 같이 다른 맥락에서 "전자레인지"를 식별하지 못하는 경우  
2) "전자레인지"만 있는 실내 주방 장면에서도 "냉장고"를 환각.  
  
동시에 발생하는 편견의 문제는 시각적 속성에서도 널리 퍼져 있다.  
예를 들어, Deep Fashion 데이터 세트에서 "공중그네" 속성은 "줄무늬"와 함께 강하게 나타난다.  
그 결과 "꽃무늬"가 있는 옷에서 "그네"를 인식하는 데 어려움을 겪는 덜 신뢰할 수 있는 분류기가 생성된다.  
최근 연구에 따르면 언어 및 시각 데이터 세트 모두에 내재된 bias로 인해 학습 모델이 저지르는 훨씬 더 심각한 실수가 확인되었다.  
인종과 특정 스포츠 활동, 성별과 직업, 유명인의 연령과 성별 간의 학습 상관 관계가 있다.  
데이터의 편향으로 인한 심각한 혼란은 실제 응용 프로그램에서 이러한 모델의 배포를 방해한다.  
이러한 문제를 감안할 때 우리의 목표는 컨텍스트가 있거나 없을 때  
범주를 정확하게 인식할 수 있는 편향되지 않은 시각적 분류기를 훈련하는 것이다.  
특히, 강한 동시 발생 bias가 있는 두 category가 주어지면 우리의 목표는 둘 중 하나가 독점적으로 발생할 때  
정확하게 인식하고 동시에 발생할 때 성능을 해치지 않는 것이다.  
이를 위해 두 가지 핵심 아이디어를 제안한다.  
첫째, 네트워크가 context보다 해당 픽셀 영역에 더 의존하여 category에 대해 학습해야 한다고 가정한다.  
class label만 있으므로 CAM을 "약한" 위치 주석으로 사용하고 상호 공간적 중첩을 최소화한다.  

이를 기반으로 우리는 컨텍스트에서 카테고리를 상관관계 해제하기 위해 feature 표현을 학습하는 두 번째 방법을 고안한다.  
네트워크에서 학습한 전체 기능 공간이 범주와 컨텍스트를 공동으로 나타내는 반면,  
일반적인 컨텍스트에서 발생하는 범주를 나타내기 위해 하위 공간을 명시적으로 개척한다.  
우리는 컨텍스트가 없을 때 편향된 범주가 발생하는 훈련 인스턴스에서만 이 기능 부분 공간을 학습합니다.  
다른 모든 경우에 모델은 컨텍스트를 활용해야 하므로 전체 feature 공간도 활용해야 한다.  
테스트 시에는 그러한 구분을 하지 않으며 전체 기능 공간이 동일하게 활용된다.  
따라서 그림 1의 예에서 우리의 목표는 전체 기능 공간이 "스케이트보드"와 "사람"을 공동으로 나타내는 동안  
"스케이트보드"를 나타내는 기능 부분 공간을 학습하는 것이다.  
광범위한 평가를 통해 category가 일반적인 context에서 벗어나 발생하는 어려운 경우에 대해 상당한 성능 향상을 보여준다.  
결정적으로, 우리는 우리의 구조가 category와 context가 동시에 발생할 때 인식 성능에 부정적인 영향을 미치지 않는다는 것을 보여준다.  
요약하면 다음과 같은 기여를 한다.  

1) 네트워크가 "올바른 것에서 배우도록" 가르치는 것을 목표로 공동 발생 category(4.1절)의 CAM 간의 중첩 최소화 방법 제안  
2) CAM 기반 방법의 insight를 바탕으로 category에서 context를 decorrelate하는 feature 표현을 학습하는 두 번째 방법 제안 (4.2절).  
3) 두 가지 작업, 즉 object 및 attribute 분류와 4개의 데이터 세트에 두 가지 방법을 모두 적용하고 category가 일반적인 context에서 벗어나 발생하는  
어려운 경우에 대해 강력한 기준선을 크게 향상시킨다(5절).  

![image](https://user-images.githubusercontent.com/40943064/129447518-2cb47dbd-feca-4f7b-9c1c-fd9f1c1fc348.png)


## 2. Related work
**Addressing biases:**  
이전 작업은 기존 데이터 세트가 bias를 겪고 있으며 현실 세계를 완벽하게 대표하지 않는다는 것을 보여주었다.  
따라서 이러한 데이터에 대해 훈련된 모델은 편향되지 않은 경우로 일반화하는 데 어려움이 있다.  
데이터 세트 bias를 줄이기 위한 시도에는 domain adaptation 기술 및 data resampling 이 포함되어 소수 클래스 인스턴스가 더 잘 표현된다.  
Data resampling의 한 가지 제한 사항은 데이터 세트를 줄이는 것과 관련되어 최적이 아닌 모델로 이어질 수 있다는 것이다.  
최근의 GAN은 학습된 feature 표현의 bias를 완화하면서 당면한 작업의 성능을 최적화하려고 시도한다(예: 연령을 분류하는 동안 성별 편향 제거).  
그러나 이러한 방법은 context(편향 요인)가 인식에 여전히 유용할 수 있으므로 contextual 편향을 완화하는 데 직접 적용할 수 없으므로 단순히 제거할 수 없다.  
다른 사람들은 caption(예: 성별 편향), classification(예: 인종 편향) 및 object detection(예: 사회경제적 편향)과 관련하여 다양한 형태의 편향을 연구한다.  
전반적으로 시각적 인식의 contextural bias는 상대적으로 탐구되지 않은 상태로 남아 있다.  

**Co-occurring-bias:**  
Contextual bias는 NLP 분야에서 잘 연구된 문제이지만 컴퓨터 비전 커뮤니티에서는 훨씬 덜 연구되었다.  
비전에서는 대부분의 노력이 context를 유용한 신호로 간주한다.  
몇 가지 노력을 통해 인식 모델은 동시 context 없이 객체를 인식하지 못하지만 솔루션을 제안하지는 않는다.  
최근의 방법은 비디오 동작 인식의  편향을 감소시키지만, 그것은 시간 정보에 의존하기 때문에 본 연구에서 다루는 영상 인식 문제에 적용할 수 없다.  
사전 심화 학습 접근법은 속성의 의미 그룹 형태의 추가 지식을 활용하여 시각적 속성 간의 상관관계(편향)를 감소시킨다.  
최근 집중적인 전경 기능을 학습하여 객체 감지에 대한 상황 편견을 줄이려고 했지만 값비싼 경계 상자 주석이 필요하다.  
이와 대조적으로, 우리의 딥러닝 접근법은 객체/속성 클래스 라벨 외에 어떠한 추가 감독도 요구하지 않는다.  
우리가 아는 가장 중요한 것은, 본 논문에서와 같이 객체 분류에 대한 문맥적 편견을 완화하는 데 초점을 맞춘 사전 연구가 없다는 것이다.  

**Relation to few-shot learning:**  
마지막으로, context bias는 일반적으로 동시 발생 context(예: 옆에 마우스가 없는 키보드) 없이 객체가 나타나는 이미지가 있기 때문에  
few-shot 또는 class imbalance 문제로 공식화될 수도 있다. 비교적 드물지만 이러한 희귀한(독점적인) 이미지를 별도의 클래스로 처리하거나  
단순히 더 높은 가중치를 할당하는 것은 실험에서 보여주듯이 차선책이 될 수 있다.  

## 3. Problem Setup
우리의 방법은 몇 가지 category에 해당하는 훈련 데이터 분포가 동시 발생 bias를 겪는다는 전제에서 작동한다.  
이제부터는 biased category라고 한다. 우리는 테스트 데이터 분포에 대해 그러한 가정을 하지 않는다.  
예를 들어 COCO-Stuff에는 “ski”가 “person”과 함께 발생하는 이미지가 2209개 있지만 “ski”가 “person” 없이 나오는 이미지는 29개뿐이다.  
이러한 왜곡된 데이터에 대해 훈련된 모델은 "스키"가 단독으로 발생하는 경우 인식하지 못할 수 있다.  
우리의 목표는 그러한 훈련 데이터 편향에 강한 특징 공간을 배우는 것이다.  
아마도 편향되지 않은 테스트 데이터 세트가 주어지면 우리의 목표는 (1) "스키"가 별도로 발생할 때 올바르게 식별하고  
(2) "스키"가 "사람"과 함께 발생할 때 성능을 잃지 않는 것이다.  
우리 접근 방식의 핵심 측면은 다음에 설명하는 주어진 데이터 세트에 대해 가장 편향된 범주를 식별하는 것이다.  
### 3.1. Identifying biased categories
M개 category의 어휘가 있는 다중 레이블 교육 데이터 세트에서 분류기를 학습한다고 가정해보자.  
이러한 category 중 일부만이 context 1 편향을 겪고 있다. 따라서 우리 접근 방식의 핵심 측면은 0 ≤ j < **K**인  
이 **K**  쌍 S = {(bj , cj )} 세트를 찾는 것이다.  
이후로 bj(예: "ski")는 높은 동시 발생으로 인해 cj(예: "person")와 가장 편향된 클래스를 나타낸다. 
**Intuition:**  
S를 구성할 여러 방법이 있지만 우리의 방법은 다음의 직관으로 만든다.  
주어진 category b는 c에의해 가장 빈번하게 bias되어있다.  
1) c가 없을때 b의 예측 확률이 현저히 떨어지는 경우
2) b가 c와 빈번하게 등장할 때 
우리는 주어진 b에 대해 c를 identify할 방법을 정의한다. 주어진 category z에 대해,  
II_b ^ II_z 그리고 II_b \ II_z 는 이미지셋을 명시하도록 한다. 여기서 b는 z와 동시에 없이 각각 발생한다.  
p^(i, b)는 이미지 i에 대한 표준 다중 label 분류기를 학습하는것으로 부터 얻어진 b 예측확률을 나타낸다.   
![image](https://user-images.githubusercontent.com/40943064/129447874-51b06d54-7757-4dda-a8c5-16ad839a0d9e.png)  
|.|은 집합의 caridnality(집합의크기)를 나타낸다.  
식 (1)은 z와 함께 혹은 없이  b category에 대한 평균 예측확률 비율을 측정한다.  
높은 값은 z에 대한 b의 높은 의존성을 의미한다.  
우리는 c를 다음과 같이 정의한다.  
![image](https://user-images.githubusercontent.com/40943064/129447948-f2f84a31-82ad-4e14-810a-1be0a656439a.png)  
즉, 각 b에 대해 (i) 가장 높은 bias 값을 산출하고 (ii) b와 함께 최소 10-20%(4.3절 참조) 동시 발생하는 범주 c를 식별한다.  
그런 다음 K개의 가장 편향된 범주 쌍으로 S를 구성한다. 우리는 위의 공식이 방향성이 있다는 점에 주목한다.  
즉, c로 인해 발생하는 b의 편향만 포착한다. 예를 들어, bias(ski, person)는 "사람"으로 인한 "스키"의 편향만을 포착하지만  
그 반대의 경우는 그렇지 않다.  
다음으로 훈련 데이터에서 동시에 발생하는 편향을 방지하기 위해 두 가지 방법을 제안한다.  
두 가지 방법에 대한 입력은 (1) 훈련 이미지 및 관련 약한(다중) 범주 레이블 및 (2) K개의 가장 편향된 범주 쌍으로 구성된  
집합 **S**(식(1)에서 식별됨)이다. 훈련 이미지에는 어떤 범주가 존재하는지 나타내는 약한 레이블만 있다는 점을 강조한다.  
이미지에서 각 범주가 어디에 있는지 알려주는 공간 주석이 없다.
## 4. Approach
첫 번째 방법은 CAM을 "약한" 자동으로 유추된 위치 주석으로 사용하고 biased category 간의 공간적 중첩을 최소화한다(4.1절).  
이 CAM 기반 접근 방식의 관찰을 기반으로 biased category가 context와 함께 발생할 때 context 공유를 장려하고 단독으로 발생할 때  
context를 억제하여 feature 공간을 학습하는 두 번째 방법을 제안한다(4.2절).  

### 4.1. CAM as “weak” location annotation
방법은 다음 전제에서 작동한다. **b**는 거의 항상 **c**와 함께 발생하므로 네트워크는  
실수로 c에 해당하는 픽셀에 의존하여 b를 예측하는 방법을 학습할 수 있다.  
이것은 c가 없을 때 b가 발생하는 이미지에서 네트워크를 테스트할 때 특히 문제가 된다.  
우리는 이 문제를 극복하는 한 가지 방법이 위치 주석을 사용하지 않고 네트워크가 c의 픽셀 영역에 덜 의존하도록  
명시적으로 강제하는 것이라고 가정한다.  
이것은 "사람" 및 "셔츠"와 같은 쌍을 가리는 데 성공하지 못할 수 있지만 "사람" 및 "스케이트보드"와 같이  
공간적으로 구별되는 category에 대한 자연스러운 제약처럼 보인다.  

**Class Activation Map:**  
이를 위해 CAM을 객체 위치 정보에 대한 proxy로 사용할 것을 제안한다. 주어진 이미지 **i**와 클래스 **r**에 대해  
CAM(i,r)은 r을 식별하기 위해 심층 네트워크에서 사용하는 판별 이미지 영역을 나타낸다.  
특히, 일반적인 네트워크의 conv. 뒤에는 GAP와 이미지 i의 클래스 r에 대한 점수를 예측하는 fc 계층이 온다.  
CAM(i,r)은 conv.에서 r에 대한 fc 레이어의 가중치를 다시 투영하고 기능 맵의 가중 평균을 계산하여 생성된다.  
CAM은 일반적으로 시각화 기술로 사용되지만 이 작업에서는 다음에 설명하는 것처럼 맥락적 편향을 줄이는 데에도 사용한다.  

**Formulation:**  
우리의 설정에서, S의 각 biased category 쌍 (b, c)에 대해 우리는 loss함수를 통해 캠들의 최소 overlap을 강제한다.  
![image](https://user-images.githubusercontent.com/40943064/129448394-84e0d731-2459-4e7d-93f6-e309f1b8cbdb.png)  

CAM은 (1) 주석 없이 클래스 레이블로 학습하고 (2) 미분 가능하므로 학습중에 end-to-end 통합 할 수 있는 두 가지 좋은 속성을 제공한다.  
이상적으로 식 (3)은 분류 성능을 손상시키지 않으면서 동시에 발생하는 범주 간의 공간적 중복을 줄이는 방법을 배워야 한다.  
그러나 중첩을 최소화하려고 시도하는 동안 식 (3)은 b와 c의 CAM이 실제 픽셀 영역에서 멀어지는 trivial 솔루션으로 이어질 수도 있다.  
강력하게 감독되는 공간 주석 없이 이를 방지하기 위해 정규화 항 LR을 도입한다.  
특히, 표준 분류 작업을 위해 별도의 네트워크(오프라인)를 사전 훈련하고 b 및 c에 대해 CAMpre를 생성한다.  
그런 다음 각 범주의 CAM을 CAMpre에서 예측한 픽셀 영역에 더 가깝게 ground한다. 따라서 LR은 다음과 같이 정의된다.  
![image](https://user-images.githubusercontent.com/40943064/129463305-f9f04626-c875-40bc-bb34-54b3ba680259.png)  
그리고 표준 BCE 로스항을 사용한다. 그러면 최종 loss는 아래와 같다.  
![image](https://user-images.githubusercontent.com/40943064/129463317-2931dd75-2f58-4f24-b595-cdc970fd3369.png)
그림 3 전체 접근법 결과(5절)에서 알 수 있듯이, CAM 기반 방법은 편향된 범주의 픽셀 영역에 더 의존하는 방법을 성공적으로 학습하여  
인식 성능을 향상시킨다. 우리의 방법은 전형적인 맥락이 없는 상황에서 biased category가 발생할 때 큰 이득을 얻는다.  
그러나 biased category가 문맥과 함께 발생할 경우 성능이 저하되는 경우가 있다(그림 7 뒷부분에서 설명).  
한 가지 이유는 동시발생 범주를 둘러싼 픽셀 영역이 편향된 범주를 인식하는 데 유용한 보완 정보를 제공하기 때문일 수 있다.  
상호 공간 중복을 억제함으로써 CAM 기반 접근법은 이 정보를 활용하지 못할 수 있다.  
이러한 핵심 insight로 기능 공간을 둘로 나누고 context와 category를 별도로 나타내면서  
공간 범위에는 제약을 가하지 않는 다음 접근 방식이 형성되었다.  

### 4.2. Feature splitting and selective context suppression


## 6. Conclusion
Biased category가 일반적인 context에서 벗어날 때 표준 분류기가 제대로 작동하지 않는다는 것을 보여줌으로써  
유명한 obejct 및 attribute 데이터 세트의 contextual bias 문제를 봤다.  
이 문제를 해결하기 위해 biased category의 feature 표현을 context에서 decorrelate 시키는 간단하면서도 효과적인 두 가지 방법을 제안했다.  
두 방법 모두 전체 성능을 유지하면서 동시에 발생하는 context에서 발생하는 biased class를 더 잘 인식한다.  
더 중요한 것은 우리의 방법이 보이지 않는 새로운 데이터 세트로 일반화되고 표준 방법보다 훨씬 더 나은 성능을 발휘한다는 것이다.  
우리의 현재 프레임워크는 범주 쌍 간의 contextual bias를 다룬다.  
미래의 노력은 더 많은 이용 가능한(scene 또는 category) 정보와 그들 사이의 모델 관계를 활용해야 한다.  
제안된 방법을 object detection 및 비디오 동작 인식과 같은 작업으로 확장하는 것은 가치 있는 미래 방향이다.
