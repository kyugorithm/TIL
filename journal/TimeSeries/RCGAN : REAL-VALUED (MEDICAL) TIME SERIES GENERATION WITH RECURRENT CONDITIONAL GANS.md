# RCGAN : REAL-VALUED (MEDICAL) TIME SERIES GENERATION WITH RECURRENT CONDITIONAL GANS

## Abstract

GAN은 사실적 데이터 생성을 위해 모델을 학습시키는 프레임워크로 놀라운 성공을 보여주었다.  
본 연구에서는 의료 데이터 적용을 위한 다차원 시계열 생성을 위해 Recurrent GAN과 반복 조건부 GAN(RCGAN)을 제안한다.  
RGAN은 G와 D에서 RNN을 사용한다. 두 RNN은 모두 보조 정보에 따라 조정된다. 우리는 toy 데이터 집합에서 모델을 시연하는데,  
여기서 우리는 모델들이 현실적인 시계열을 성공적으로 생성할 수 있다는 것을 시각적, 정량적으로 보인다.  
우리는 또한 합성 라벨링된 학습 데이터 세트를 생성하고 합성 데이터에 대해 학습된 모델의 테스트 세트 및 그 반대로 평가하는  
GAN에 대한 새로운 평가 방법을 설명한다.  
RCGAN이 테스트 데이터의 성능 저하가 미미하지만 감독 학습에 유용한 시계열 데이터를 생성할 수 있음을 이러한 메트릭으로 설명한다.  
이는 'serialised' MNIST의 자릿수 분류와 중환자실에서 17,000명의 의료 데이터 세트에 대한 조기 경고 시스템을 교육함으로써 입증된다.  
또한 RCGAN을 사용하여 실제 합성 의료 시계열 데이터를 생성할 때 발생할 수 있는 개인 정보 보호 문제에 대해 논의하고 분석하며, RCGAN의 차등 개인 훈련 결과를 입증한다.  

## 1 INTRODUCTION
데이터에 대한 접근은 도메인별 문제에 대한 머신러닝 솔루션 개발의 병목 현상 중 하나이다.  
표준 데이터 세트(관련 작업 포함)의 가용성은 여러 작업에서 학습 시스템의 기능을 향상시키는 데 도움이 되었다.  
그러나 의학과 같은 분야에서는 발전이 늦어지는 것으로 보인다. 의학에서의 작업은 단순히 더 어렵다고 제안하고 싶다.  
즉, 데이터는 더 복잡하고, 더 시끄러우며, 예측 문제는 덜 명확하게 정의된다. 
이와 관계없이, 연구자들이 접근할 수 있는 데이터의 부족은 모델 비교, 재현성을 저해하고 궁극적으로 과학적 진보를 방해한다.  
그러나 의료 데이터의 매우 민감한 특성 때문에 접근은 일반적으로 고도로 통제되거나 관련되고 불완전한 비식별화가 필요하다.  
따라서 이 연구의 동기는 현실적인 합성 의료 데이터를 생성하기 위해 GAN의 프레임워크를 활용하고 개발하는 것이다.  
이 데이터는 개인 정보 보호 문제 없이 공유 및 게시될 수 있고, 심지어 다른 환자 집단  
또는 더 작은 집단에서 수집된 유사한 데이터 세트를 강화하거나 풍부하게 하는 데 사용될 수 있다.  
더욱이 현실적인 의료 데이터를 합성할 수 있는 시스템 구축은 그러한 정보를 생성하는 프로세스를 모델링하는 것을 의미하므로  
의료 환경에서 예측 시스템을 만들기 위한 새로운 접근 방식을 개발하기 위한 첫 번째 단계를 나타낼 수 있다.  
  
기계 학습 연구 커뮤니티의 유용성 외에도, 그러한 도구는 의료계가 시뮬레이터를 훈련하는 데 사용할 수 있도록 도움을 준다.  
본 연구에서는 중환자실(ICU)의 실제 값 시계열 데이터를 합성하는 데 초점을 맞춘다.  
중환자실에서 의사들은 망설일 여유가 없는 시간에 대한 압박감 속에서 성급한 결정을 내려야 한다.  
의사를 훈련시키기 위해 시뮬레이션을 사용하는 것은 의료 훈련에서 이미 표준이지만,  
이러한 시뮬레이션은 종종 수작업 규칙과 물리적 소품에 의존한다.  
따라서 다양하고 현실적인 ICU 상황을 생성할 수 있는 모델은 특히 환자의 기본 '상태'를 조건화할 수 있는 능력이 주어졌을 때 즉시 적용할 수 있다.  
사실적으로 보이는 이미지를 생성하는 GAN의 성공은 이 작업에 대한 GAN의 적용 가능성을 시사하지만, 제한된 작업이 시계열 데이터 생성에 GAN을 활용했다.  
또한, 연구자들이 종종 생성된 예시의 시각적 평가에 의존하기 때문에 GAN의 평가는 크게 해결되지 않은 문제로 남아 있는데,  
이는 다차원 의료 시계열에는 비현실적이고 부적절한 접근법이다.  

이 연구의 주된 기여는 다음과 같다.  

1. 적대적 훈련을 사용하여 실제 값 시퀀스를 생성  
2. GAN을 평가하기 위한 새로운 접근 방식  
3. 합성 의료 시계열 데이터 생성  
4. GAN과 차등 사설 GAN의 경험적 프라이버시 분석  

## 2 RELATED WORK

2014년 이후(Goodfellow 등, 2014), GAN 프레임워크는 연구 커뮤니티의 상당한 관심을 끌었고,  
이 작업의 대부분은 이미지 생성에 초점을 맞췄다. 특히 Choi는 합성 전자 건강 기록(EHR) 데이터 세트를 생성하기 위해 GAN을 설계했다.  
EHR에는 ICD-9 청구 코드, 약물 및 절차 코드와 같은 이진 및 카운트 변수가 포함되어 있다.  
이산 값 데이터와 환자의 스냅샷 생성에 대한 그들의 초점은 우리의 실제 값 시계열 초점과 보완된다.   
향후 연구는 이러한 접근법을 결합하여 multi-modal 합성 의료 시계열 데이터를 생성할 수 있다.  
  
GAN을 사용한 sequential 데이터 생성의 대부분은 자연어 처리에 유용한 이산 토큰에 초점을 맞췄다.   
강화 학습을 기반으로 한 대체 접근방식이 GAN을 훈련시키는 데 사용된다.   
우리는 연속시퀀스를 생성하기 위해 GAN을 사용하는 한 가지 예비 작업만 알고 있으며, LSTM G/D가 있는 GAN을 사용하여   
다성음악을 생성하는 것을 목표로 한다. 주요 차이점은 구조이다. 양방향 D를 사용하지 않으며,  
G의 출력은 다음 단계에서 입력으로 피드백되지 않는다. 또한, 우리는 이 recurrent GAN의 conditional 버전을 소개한다.  

cGAN은 추가 정보에 따라 모델을 조건화하므로 데이터 생성 프로세스를 지시할 수 있고 이미지 생성 작업에 사용되어 왔다.   
최근 cGAN은 번역과 대화 생성을 포함한 자연어 처리에도 사용되고 있으며, 여기서 D의 선호 선택으로 RNN을 사용하는 경우는 없으며,  
앞서 언급한 바와 같이 이산적인 NAT으로 인해 RL 접근방식이 모델을 훈련하는 데 사용된다.  

이 작업에서는 또한 생성된 합성 데이터의 기능을 사용하여 학습된 모델을 교육하는 몇 가지 새로운 접근 방식을 소개한다.   
이와 관련하여, GAN 기반 semi-supervised 학습 접근법이 도입되었다.   
그러나 우리의 목표는 GAN이 학습되는 순간 알려지지 않은 작업에 대한 모델을 훈련하는 데 사용할 수 있는 데이터를 생성하는 것이다.  

우리는 특히 민감한 의료 데이터와 관련이 있는 더 강력한 프라이버시 보장을 가진 RGAN을 생성하기 위해  
차등 비공개 확률적 경사 하강법(Abadi 등, 2016)의 사용을 간략히 탐구한다.  
대체 방법은 판별기를 훈련시키기 위해 PATE 접근방식(Papernot 등, 2016)을 사용하는 것이다.   
이 경우 (Abadi et al., 2016)에서와 같이 학생 분류기는 (Abadi et al., 2016) 데이터의 분리된 집합에 대해  
각각 훈련된 교사 앙상블의 시끄러운 표를 예측하도록 훈련된다.  


## 3 MODELS: RECURRENT GAN AND RECURRENT CONDITIONAL GAN

### 3.1 EVALUATION

#### 3.1.1 MAXIMUM MEAN DISCREPANCY
#### 3.1.2 TRAIN ON SYNTHETIC, TEST ON REAL (TSTR)

## 4 LEARNING TO GENERATE REALISTIC SEQUENCES
### 4.1 SINE WAVES
### 4.2 SMOOTH FUNCTIONS
### 4.3 MNIST AS A TIME SERIES
