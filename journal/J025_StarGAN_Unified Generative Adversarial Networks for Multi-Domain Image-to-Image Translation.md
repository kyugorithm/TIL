# StarGAN: Unified Generative Adversarial Networks for Multi-Domain Image-to-Image Translation

## Abstract
두 영역에 대한 I2I 변환연구는 많은 성공이 있었지만 기존 방식은 모델이 많이 필요하므로  
3개 이상의 도메인을 처리하는데 제한적이며 한계를 해결하기 위해 **단일 모델**으로 여러 도메인에 대해  
I2I 변환을 수행할 수 있는 새롭고 확장 가능한 접근 방식인 StarGAN을 제안한다.  
통합 모델 아키텍처를 통해 단일 네트워크 내에서 **서로 다른 도메인을 가진 여러 데이터 세트를 동시에 교육**할 수 있다.  
이는 StarGAN의 우수한 변환 이미지 품질과 원하는 대상 도메인으로 입력 이미지를 유연하게 변환하는 새로운 기능으로 이어진다.  
우리는 얼굴 attribute 전송과 얼굴 expression 합성 작업에 대한 접근 방식의 효과를 경험적으로 입증한다.  

## 1. Introduction
I2I 변환작업은 이미지의 특정부분을 바꾸는 것이다. (e.x.,미소 > 찡그린 얼굴 / 그림 1 참조)  
<img src = "https://user-images.githubusercontent.com/40943064/133195077-8a616cdf-fc14-4105-b2e1-130fb8f6bc27.png" width=500 height=250>
머리카락 색 변경, 에지 맵의 사진 재구성 및 풍경 이미지의 계절 변경의 결과로 GAN의 도입 이후 상당한 개선을 경험했다.  
서로 다른 도메인의 학습 데이터를 감안할 때, 이러한 모델은 도메인간 이미지를 변환방법을 배운다.  
모발 색, 성별 또는 나이와 같은 내재된 특성인 attrubute(예: 모발 색상의 경우 검은색/금발/갈색 또는 성별의 경우 남성/여성)을 의미한다.  
또한 도메인이 동일한 attribute를 공유하는 이미지 집합임을 나타낸다. 여러 이미지 데이터 세트에는 레이블이 지정된 여러 attribute가 함께 제공된다.  
CelebA : 머리카락 색, 성별 및 나이등의 속성 40개 레이블  
RaFD : '행복', '분노', '슬픔' 등 표정에 대한 8개의 레이블  
이러한 설정을 통해 여러 도메인의 속성에 따라 이미지를 변경하는 다중 도메인 I2I 변환과 같은 보다 흥미로운 작업을 수행할 수 있다.  
그림 1의 5개 열은 CelebA의 '금발', '젠더', '연령', '수염 피부'의 네 가지 도메인 번역 결과를 보여준다.  
가장 오른쪽 열에서와 같이 RaFD에 대한 훈련을 통해 학습한 기능을 사용하여 CelebA 이미지의 표정을 변경하기 위해  
CelebA 및 RaFD 이미지를 공동으로 훈련하는 등 서로 다른 데이터 세트의 여러 도메인 훈련으로 확장할 수 있다.  
  
그러나 기존 모델은 이러한 다중 도메인 이미지 변환 작업에서 비효율적이고 비효과적이다.  
이러한 비효율성은 k 도메인 간의 모든 매핑을 학습하기 위해 k*(k-1) G를 훈련해야 한다는 사실에서 비롯된다.  
그림 2(a) 12개의 고유 G가 4개의 도메인에서 이미지를 변환하기 위해 어떻게 훈련되어야 하는지를 보여준다.  
<img src = "https://user-images.githubusercontent.com/40943064/133195421-52641469-768c-4487-a4ae-7e630bd9d7eb.png" width=400 height=350>  
얼굴형과 같은 모든 영역의 이미지에서 학습할 수 있는 전역적 특징이 존재하더라도 각 G는 전체 훈련 데이터를 완전히 활용할 수 없으며  
k 도메인 중 두 도메인에서만 학습할 수 있다. 교육 데이터를 완전히 활용하지 못하면 생성된 이미지의 품질이 제한될 수 있습니다.  
또한, 각 데이터 세트는 부분적으로 라벨이 부착되어 있기 때문에 서로 다른 데이터 세트의 도메인을 공동으로 교육할 수 없으며, 우리는 이를 3.2절에서 자세히 논의한다.  
이러한 문제에 대한 해결책으로 여러 도메인 간의 매핑을 학습할 수 있는 새롭고 확장 가능한 접근법인 StarGAN을 제안한다.  
그림 2 (b)에서 설명한 바와 같이, 우리 모델은 여러 도메인의 훈련 데이터를 받아들이고 단일 생성기만을 사용하여 사용 가능한 모든 도메인 간의 매핑을 학습한다.  
아이디어는 간단하다. 고정 번역(예: 검정-금발 머리)을 배우는 대신, 우리의 생성자는 이미지와 도메인 정보를 모두 입력으로 받아들이고  
이미지를 해당 도메인으로 유연하게 변환하는 방법을 배운다. 도메인 정보를 나타내기 위해 레이블(예: 이진 또는 단일 핫 벡터)을 사용한다.  
훈련 중에, 우리는 무작위로 대상 도메인 레이블을 생성하고 입력 이미지를 대상 도메인으로 유연하게 변환하도록 모델을 훈련시킨다.  
이를 통해 도메인 레이블을 제어하고 테스트 단계에서 원하는 도메인으로 이미지를 변환할 수 있습니다.  
또한 도메인 레이블에 마스크 벡터를 추가하여 서로 다른 데이터 세트의 도메인 간에 공동 교육을 가능하게 하는 간단하지만 효과적인 접근 방식을 소개한다.  
우리가 제안한 방법은 모델이 알 수 없는 레이블을 무시하고 특정 데이터 집합에서 제공하는 레이블에 집중할 수 있도록 한다.  
이런 식으로 셀레브A 이미지의 표정 합성 같은 작업을 잘 해낼 수 있다.
