## Improving Robustness and Accuracy via Relative Information Encoding in 3D Human Pose Estimation 

## Abstract
기존의 3D human pose estimation 방법 대부분은 인체의 전체 궤적(전체 움직임) 대신 root 관절과 다른 인체 관절(국소적 움직임) 사이의 3D 위치 관계를 예측하는 데 주로 집중한다. 그러나 전체적인 움직임에 약하고, 작은 국지적인 움직임을 정확하게 예측하지 못한다. 이러한 두 가지 문제를 완화하기 위해, 위치/시간적 강화된 표현을 생성하는 **상대적 정보 인코딩 방법**을 제안한다. 첫째, 2D 포즈의 상대 좌표를 활용하여 위치 정보를 인코딩하여 **입력과 출력 분포의 일관성을 높힌다**. 절대 2D 위치가 다른 동일한 자세를 공통 표현에 매핑할 수 있다. 예측 결과에 대한 전역 움직임의 간섭에 저항하는 것이 좋다. 둘째, 일정 기간 내에 동일한 사람의 현재 포즈와 다른 포즈 간의 연결을 확립함으로써 시간 정보를 인코딩한다. 현재 포즈 전후의 움직임 변화에 더 많은 주의를 기울여서 움직임 범위가 작은 국소 움직임에서 더 나은 예측 성능을 얻을 수 있다. 절제 연구는 제안된 상대 정보 인코딩 방법의 효과를 검증한다. 또한, 우리는 위치 및 시간적 강화된 표현을 더욱 활용하기 위해 전체 프레임워크에 다단계 최적화 방법을 도입한다. 
## 1. Introduction
이 문제는 3D 포즈가 2D 공간에서 동일한 투영을 가질 수 있는 모호성으로 인해 어렵다. 기존 방법은 Pictorial Structure(PS) 모델을 3D 포즈 추정으로 확장하거나 수작업으로 만든 feature를 사용하여 인간의 포즈를 복구한다. 3D 대규모 모션 캡처 데이터 세트로 NN을 활용하여 3D 좌표를 회귀하는 학습 기반 방법이 유망한 결과를 얻었다.  
최근에는 3D 포즈 추론을 위한 2단계 원칙을 따른다. 2D 인간 키포인트를 위치화하고, 이전 단계의 결과로 3D 접합 위치를 예측하는 것이다. 이 방식은 2D 키포인트를 3D 스켈레톤으로 끌어올리는 프로세스에 초점을 맞춘다. 이를 통해 2D 좌표의 사전 정보를 활용하여 3D 인체 자세 추정을 용이하게 할 수 있다. 본 연구은 이 범주에 속한다.  

#### Global and Local Motions
그림 1과 같이 인체의 운동은 전역 운동과 국소 운동으로 나눌 수 있다. 전작 대부분은 전역 운동 대신 국소 운동 예측에 주목한다. 근관절(골반)에 대한 상대 좌표의 형태로 3D 인체 관절을 나타낸다. 이러한 방식은 두 가지 단점이 있다.  
  
1) 전역 움직임에 대한 견고성이 부족하다. 2D 포즈의 절대 위치만 입력으로 사용하므로 입력과 출력 사이의 불일치가 발생한다. 실제, 카메라의 위치가 자주 바뀌는데, 이것은 2D keypoint의 전역적 움직임이라고 볼 수 있다. 이것은 다른 절대 2D 위치를 가진 사람의 같은 자세가 다른 출력에 대응한다는 심각한 문제를 야기한다. 즉, 예측 결과는 카메라의 움직임에 영향을 받는다.  
2) 국소 움직임에 대한 부정확한 예측 결과를 생성한다. 일정 시간 내에 2D 좌표를 사용하여 특정 프레임에 있는 사람의 3D 자세를 예측한다. 이는 현재 포즈와 다른 모든 포즈의 관계를 무시하고 모든 포즈를 동등하게 다룬다. 이는 네트워크가 국지적 움직임의 작은 변화에 민감하지 않기 때문에 이동범위가 작은 포즈에서는 예측 퍼포먼스가 저하됨을 나타낸다.   
<img src="https://user-images.githubusercontent.com/40943064/160277304-dd2e588b-bcec-46c4-afb2-3ae4b0afa538.png" width=300>. 

#### Relative Information Encoding Method
위 문제를 완화하기 위해 상대적인 정보 인코딩 방법을 제안한다. 인체 그룹화 전략을 활용한 Feature Fusion Network라는 기준선에서 시작한다. 상대 정보 인코딩은 baseline에 대한 추가 입력으로 위치/시간적 표현을 생성한다.  
1) 출력과의 일관성을 보장하기 위해 입력의 루트 관절에 대한 상대적인 2D 좌표를 사용하여 위치 정보를 인코딩한다. 이렇게 하면 인체의 절대적인 위치에 방해받지 않고 자세 관련 정보를 증류할 수 있다. 영상 평면에서 2D 키포인트 위치가 전체적으로 이동하더라도 위치 정보 인코딩 후 결과는 여전히 동일하다. 따라서 3D 포즈 예측은 글로벌 움직임에 대해 더욱 강력해진다.  
2) 이동 범위가 작은 국소 운동에서 더 나은 추정 성능을 달성하기 위해 현재 포즈의 영향을 다른 포즈로 명시적으로 전파하여 시간 정보를 인코딩한다. 시간 정보 인코딩은 내적 및 감산 등 모든 벡터 연산자로 모델링할 수 있다. 각 포즈의 절대 위치 대신 현재 포즈와 관련된 상황별 포즈의 위치 변화가 강조된다. 이동 범위가 작은 국소 모션의 경우 현재 포즈와 다른 포즈 간의 변화가 확대되어 보다 정확한 예측 결과에 기여한다.  

위치 및 시간적 강화된 표현이 도출된 후, 이러한 표현에서의 pose 정보는 Feature Fusion Network의 각 신체 그룹에서 독립적으로 추출되어야 한다. 이어서, 인간의 신체 구조에 대한 사전 지식은 이전 과정을 방해하지 않고 그룹 간에 전달될 필요가 있다. 이를 위해 전체 프레임워크에 대한 다단계 최적화 방법을 제안한다. 이 방법은 위의 두 프로세스를 순차적으로 최적화하여 독립성을 유지한다.  
요약하면, 본 논문의 기여는 아래와 같다.  
1) Positional information encoding : 전역 움직임에 더욱 강인한 예측 결과 생성
2) Temporal information encoding : 작은 움직임을 가지는 국소적 움직임에 더욱 정확한 예측 결과 생성
3) Multi-stage optimization method : 시공간적 인코딩 정보를 더 잘 활용하기 위해 전체 프레임워크에서 사용

## 2. Related works
초기 연구는 한번에 3D human 관절을 회귀하지만 최근에는 두단계 작업을 많이 활용한다. 아래에서 학습기반의 두단계 접근방식을 소개한다.  
### 2.1 Anatomical Grouping Strategy
많은 방법은 성능개선을 위해 관절 사이에 존재하는 내부 구조적 제약을 활용한다. 최근에는 인체를 국소 그룹으로 분할해 관절의 공통성을 포착하는 해부학적 그룹화 전략이 널리 활용되고 있다. 
1) Park : **계층적 관계 네트워크**를 통해 그룹 내 관절 간의 상호의존성을 파악  
2) Fang : 인체 부위 간의 상위 관계를 인코딩하는 포즈 문법을 개발
3) Wang : 인체를 다양한 자유도를 가진 여러 부분으로 나누고 부품 간의 양방향 종속성을 명시적으로 모델
4) Zheng : 각 관절을 국소 특성이 추출되는 독립적인 그룹으로 간주한다.  
5) Zeng : 로컬 그룹에 저차원 글로벌 컨텍스트를 통합하기 위한 분할 앤 라인 접근방식  
마찬가지로 본 연구는 신체 부위를 5개의 그룹으로 분류하고 Feature Fusion Network라는 기준선을 구축한다. 이러한 그룹 간의 연관성을 명시적으로 모델링하기 위해 FFM(Feature Fusion Module)을 개발했다. 모든 컨볼루션 레이어에서 정보를 교환하는 방법과 대조적으로, 우리의 접근 방식은 인코더 네트워크 후에만 feature fusion을 구현한다. 이와 같이 local feature 추출 프로세스와 feature fusion 프로세스가 분리된다. 제안된 다단계 최적화 방법을 통해 각 그룹의 인코더는 다른 그룹의 간섭 없이 독립적으로 작동할 수 있다.  

### 2.2 Positional Information
많은 최근 연구는 출력단에서 3D 인간 포즈의 reparametrizzation 방법을 제안한다.  
Sun : 인간의 자세를 나타내기 위해 관절 대신 뼈를 사용하고 학습을 위한 구성 손실 함수를 정의하기 위해 관절 연결 구조를 이용한다.  
Mehta : root 또는 1순위의 부모에 대한 상대적 위치 등 다양한 방법으로 공동 위치를 나타낸다.  
다른 작품 : 인간 관절의 좌표를 모관절에 대해 극좌표계에서 축과 각도로 분해하여 특정인의 골격 길이를 통일하기 쉽게 한다.  
그러나 기존의 모든 접근 방식은 인체의 자세를 포착하는 더 나은 3D 표현을 찾는 데만 초점을 맞추고 있다. 입력과 출력 분배의 균일성을 확보하기 위한 노력은 거의 이루어지지 않았다. 그 결과, 카메라 위치 오프셋등의 글로벌 모션이 발생하면, 퍼포먼스가 저하한다. 반대로, 우리는 입력과 출력 양쪽의 루트 조인트에 대한 상대 좌표계의 포즈를 나타내는 위치 정보 부호화 방법을 제안하여 글로벌 움직임의 부정적인 영향을 제거한다.

### 2.2 Temporal Information
시간적 일관성을 유지하고 비디오의 떨림을 완화하기 위해, 비디오 시퀀스에서 추론하는 3D 포즈의 시간적 정보를 이용하는 많은 접근법이 제안되었다. 최근 LSTM 모델이 3D 인체 자세 추정에 도입되었다.  
호사인 : 3D 포즈 시퀀스를 추정하기 위해 LSTM 단위로 구성된 시퀀스 모델을 제안  
쉬    : bi-directional LSTM을 사용하여 3D 궤적을 개선할 것을 제안  
린    : 모든 입력 프레임을 동시에 처리하고 매트릭스 factorization을 이용하여 LSTM 모델의 드리프트 문제를 처리
파벨로 : 시간 순서에 따라 1D 컨볼루션을 수행하는 TCN(Temporal Convolutional Network)을 제안 : 일련의 2D 포즈가 이용되어 현재의 3D 포즈가 공동으로 추정된다. 더 적은 파라미터로 더 높은 정확도를 달성할 수 있으나 모든 2D 포즈는 TCN에 의해 사용되는 시간 1D 컨볼루션에 의해 동등하게 취급된다. 현재 포즈와 다른 포즈의 차이를 간과한다.  
Liu : TCN에 attention 메커니즘을 적용했지만, 중간 계층의 텐서만 가중치를 부여하며, 현재 포즈의 중요성은 여전히 명시적으로 강조되지 않는다. 현재 포즈와 다른 포즈의 관계는 암묵적으로 모델링되므로 네트워크의 부담이 증가한다. 그 결과, 포즈간의 작은 차이가 네트워크에 의해서 포착될 가능성이 적어지기 때문에, 예측 결과가 나빠집니다.  
이러한 작업과 달리 현재 프레임과 다른 프레임 간의 직접적인 상관관계를 구축하여 시간 정보를 명시적으로 인코딩한다. 이 방법은 작은 이동 범위로 로컬 모션의 추정 성능을 향상시킨다.

## 3. Proposed method
프레임워크 개요를 그림 2에 나타낸다. 2D 키포인트 시퀀스를 입력으로 사용하고 현재 프레임에서 출력으로 단일 3D 포즈를 생성한다. 인체의 구조 정보를 활용하기 위해 autoencoder 패러다임을 기반으로 Feature Fusion Network라는 기준선을 구축한다. 공간적으로 연관된 조인트를 동일한 그룹에 할당하고, 그룹화된 조인트의 공통성을 모델링하기 위해 공유 피쳐를 학습할 수 있다. 각 그룹의 관절 위치를 독립적으로 예측하는 것이 물리적으로 불가능한 신체 움직임을 유발할 수 있다는 사실을 고려하여, 그룹 간의 의존성을 나타내기 위해 [43]과 유사한 feture fusion module (FFM)을 제안한다. 그룹 간 구조적 연관성을 확립하고 생성된 3D 포즈가 합리적인지 확인하는 데 유용하다. 전역 움직임에 대한 견고성 결여와 국소 운동의 부정확한 예측 결과의 문제를 완화하기 위해, 상대 정보 인코딩 방법을 제안한다. 이 방법을 사용하여 기준선에 대한 추가 입력 역할을 하는 **위치 및 시간적 강화 표현(KΩ, KΩ)**을 산출한다.  
<img src = "https://user-images.githubusercontent.com/40943064/160278544-a3b3fea9-2924-4cbf-be97-b15908ed72ea.png" width = 600>
### 3.1 Baseline
### 3.2 Positional Information Encoding
### 3.3 Temporal Information Encoding
### 3.4 Multi-Stage Optimization
