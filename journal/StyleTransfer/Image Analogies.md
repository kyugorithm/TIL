# Image Analogies

## Abstract
'Image analogies'라 불리는 이미지 처리 프레임워크를 설명한다.  

두가지 stage가 있다.  
1) Design Phase : 한 이미지가 다른 이미지의 "필터링된" 버전이 되도록하는 한쌍의 이미지 (학습데이터로 표현)  
2) Application Phase : 학습된 필터가 일부 새로운 대상 이미지에 적용되어 "필터링된" 결과 생성  

Image Analogies는 최근 텍스쳐 합성의 결과에 우선적으로 영감을 받은 단순 다중스케일 자기회귀를 기반으로 한다.  
여러 타입의 source 쌍들을 입력으로 선택해서, 프레임웍은 광범위한 'image filter' 효과를 지원한다.  
1) Traditional image filters : 블러링 / 엠보싱  
2) Improved texture synthesis : 과거 방법론보다 더 향상된 품질의 질감합성  
3) Duper-resolution : 저해상도 source로부터 고해상도 이미지 추론  
4) Texture transfer : 이미지에 대한 임의의 source 질감 적용  
5) Artistic filters : 실세계 사례를 기반하여 합성된 다양한 drawing/painting 스타일  
6) Texture-by-numbers : 단순한 페인팅 인터페이스를 사용하여 다양한 질감으로 구성된 사실적 장면 생성  

## 1 Introduction
**a'nal'o'gy** n.  
_대상 구조의 개체 간의 관계와 속성을 추론하기 위해 소스 구조의 개체 간의 관계와 속성을 사용하는 구조 간의 체계적인 비교  
유추를 인식하는 타고난 재능은... 천부적 천재성의 으뜸가는 사실._  
**William James, 1890**
Analogy는 기본 추론 과정으로 문제를 풀거나 예시를 제공하거나 예측을 할때 꽤 일반적으로 사람으로써 사용하는 것이다.  
본 논문에서, 우리는 analogy를 복잡한 이미지 필더들을 생성하기 위한 수단으로써 탐험한다.  
![image](https://user-images.githubusercontent.com/40943064/146486372-60c1c561-9547-4c58-aad4-c0b2f7faa1cb.png)
특히, 다음의 문제 해결을 시도한다. :  
  
Problem (“IMAGE ANALOGIES”):  
이미지 A와 A' 쌍이(각각 original/filtered source image)이 주어지면 필터링되지 않은 일부 추가 대상 이미지 B와 함께  
다음과 같이 새로운 필터링된 대상 이미지 B'를 합성한다.  
  
A : A' :: B : B'  
  
즉, A가 A'와 관련된 "같은 방식"으로 B와 관련된 "유사한" 이미지 B'를 찾는다.  
일반적으로 이것은 해결하기 매우 어려운 문제이다.  
이 논문에서 많은 경우에 잘 작동하는 접근 방식을 설명한다.  
Image analogies의 장점은 이미지 변환을 지정하는 매우 자연스러운 수단을 제공한다는 것이다.  
무수히 많은 다양한 필터와 해당 설정 중에서 선택하는 대신 사용자는 적절한 예시(필터링되지 않은 해당 소스 이미지와 함께)를 제공하고  
사실상 "이렇게 보이게 하세요"라고 말할 수 있다.  
이상적으로는 이미지 유추를 통해 매우 복잡하고 비선형적인 이미지 필터를 배울 수 있어야 한다.  
이러한 스타일의 실질적(실생활의) 렌더링과 유사하다.  
또한 이러한 다양한 유형의 필터를 개별적으로 발명하거나 명시적으로 프로그래밍할 필요가 없다.  
이상적으로는 이와 같이 매우 다양한 효과를 제공하기 위해 동일한 일반 메커니즘을 대신 사용할 수 있다.  
이미지 유추는 분명히 바람직한 목표이지만 어떻게 달성할 수 있는지는 명확하지 않다.  
  
우선, 이미지 유사성 문제 진술의 중요한 측면은 필터링되지 않은 각 이미지와 각각의 필터링된 버전 간의 관계뿐만 아니라 전체적으로 보았을 때  
소스 쌍과 대상 쌍 간의 관계도 측정하는 데 사용되는 유사성의 정의이다.  
이 문제는 까다롭다.  
A에서 A'까지 원본 이미지 필터의 인식 가능한 특징을 보존할 수 있는 메트릭을 사용하는 동시에 완전히 다른 대상 이미지 B에도 적용할 수 있다.  
게다가, 학습 쌍의 어떤 특징이 필터의 "스타일"을 구성하는지 명확하지 않다:  
원칙적으로, 한 쌍의 이미지로부터 무한한 수의 다른 변환을 추론할 수 있다.  
본 논문에서, 우리는 원시 픽셀 값과 선택적으로 조정 가능한 필터 응답을 사용하여 마르코프 무작위 필드 모델의 근사치를 기반으로 하는 유사성 메트릭을 사용한다.  
소스와 대상 이미지 쌍 사이의 관계를 측정하기 위해 섹션 3에서 논의하는 것처럼 이미지 내의 작은 이웃의 공동 통계를 샘플링한다.
  
추가로, 우리는 필터링된 대상 이미지 B의 합성이 합리적인 속도로 진행되기를 바란다.  
따라서 유사성 메트릭을 사용하여 다양한 이미지 A, A' 및 B를 색인화하고 효율적으로 검색하여 B → B'를 합성하는 데 있어  
변환 A → A'의 적절한 부분을 선택할 수 있는 방법이 필요하다.  
우리는 주로 Wei와 Levoy및 Ashikh에 의한 텍스처 합성에 대한 최근 연구를 기반으로 한 autoregression 알고리즘을 사용한다.  
실제로, 우리의 접근 방식은 단일 텍스처가 아니라 해당 이미지 쌍의 상황에 대한 일반화와 함께 이 두 가지 접근 방식의 조합으로 생각할 수 있다.  

마지막으로 이미지 A의 통계를 완전히 다른 색상의 이미지 B에 적용하기 위해 섹션 3.3 및 3.4에 자세히 설명된 대로 사전 처리된 휘도 공간에서 작동하기도 한다.  
  
실제 사용에서는 두 단계를 포함하는 이미지 유사성을 구상한다.  
설계(또는 학습) 단계에서 디자이너(예: 전문가)는 학습 이미지 A 및 A(예: 스캔된 이미지)를 선택하고, 원하는 경우 이미지에 주석을 달며,  
이미지 유추에서 다양한 유형의 이미지 기능이 가중되는 방식을 제어하는 매개 변수를 선택하여(직간접적으로) 필터를 생성한다.  
그런 다음 필터는 라이브러리에 따로 저장할 수 있다.  
나중에 애플리케이션 단계에서 사용자(아마도 이미지 필터를 만드는 데 전문 지식이 전혀 없는 사람)가 일부 대상 이미지 B에 필터를 적용한다.  
분명히, 우리는 우리의 이미지 아날로그 프레임워크가 특히 단일 훈련 쌍에서 가능한 모든 이미지 필터를 학습하고 시뮬레이션하는 데 있어  
완벽한 역할을 하기를 기대할 수는 없다.  
게다가, 우리가 우리의 틀이 배울 수 있기를 바라는 많은 필터들은 사실, 심지어 인간들도 숙달하기 매우 어렵다.  
그럼에도 불구하고, 우리는 섹션 4에서 설명된 바와 같이 다양한 상황에서 우리의 이미지 유사성 프레임워크가 상당히 잘 작동한다는 것을 발견했다.  
여기에는 다음이 포함된다.  

• traditional image filters : 블러링, 엠보싱 (4.1)  
• improved texture synthesis : 과거 방식 보다 고품질의 텍스처 합성 (4.2)  
• super-resolution : 저차원 소스로부터 고차원 추론 (4.3)  
• texture transfer : 임의 소스 질감 적용 (4.4)  
• artistic filters : 다양한 drawing/painting 스타일(oil/watercolor/line art rendering) (4.5)  
• texture-by-numbers, : 단순한 페인팅 인터페이스를 사용하여 다양한 질감으로 구성된 사실적 장면 생성 (4.6)  

이 모든 경우에 다양한 효과를 생성하는 것은 주로 단지 입력으로 다른 유형의 소스 이미지 쌍을 제공하는 문제이다.  
예를 들어, 블러 필터는 이미지와 그 블러를 (A, A') 쌍으로 제공함으로써 학습된다.  
마찬가지로, 오일 페인팅 스타일은 입력 쌍으로서 이미지와 오일 페인팅된 동등한 이미지를 제공하여 학습된다.  
일반적인 텍스처 합성은 필터링되지 않은 이미지 A와 B가 null이고 분석/합성이 A와 B에서만 수행되는 이미지 유사성의 특별한 경우로 볼 수 있다.  
예를 들어, A의 한 단색은 A의 "하늘 질감"에 해당하고, 다른 색은 "풀 질감"에 해당하며, 다른 색은 "풀 질감"에 해당한다.  
이 같은 색들을 B에 칠하면 비슷한 질감으로 사실적인 새로운 풍경 B를 만들 수 있다.  
  
마지막으로, 우리는 또한 디지털 페인팅 도구의 풋프린트 아래에 이미지 유사성을 제공하는 데 사용할 수 있는 알고리즘의 실시간 대화형 버전을 설명한다(섹션 5).  
텍스처 바이 넘버는 이 도구에 자연스럽게 적용되지만, 어떤 유형의 이미지 유추에도 사용할 수 있다.  
  
여러 면에서 성공적이긴 하지만 이미지 쌍의 낮은 수준의 통계만 모델링하려고 하기 때문에 모든 경우에 이미지 유사성이 작동하는 것은 아니다.  
따라서 광범위하고 일관된 브러시 스트로크와 같은 높은 수준의 특징이 항상 효과적으로 포착되거나 전달되는 것은 아니다.   
6절에서는 접근법의 한계를 논의하고 향후 연구 영역을 제시한다.  
 
